<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AiTable - Excel 数据可视化</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js" integrity="sha384-wuxEG2Xm9sr+j7+jmwjAQwJvlPL1jPPSIDB3J14k5KSu8F8Dc6X0rXU3c/6FltaY" crossorigin="anonymous"></script>
  </head>
  <body>
    <header>
      <div class="container">
        <h1>AiTable Excel 数据看板</h1>
        <p>上传 Excel 文件，快速查看数据并生成图表。</p>
      </div>
    </header>
    <main class="container">
      <section class="card">
        <form id="upload-form">
          <label class="file-label" for="excel-file">选择 Excel 文件</label>
          <input
            id="excel-file"
            type="file"
            accept=".xlsx"
            required
          />
          <button type="submit">上传并分析</button>
          <span id="status" role="status" aria-live="polite"></span>
        </form>
      </section>

      <section id="error-box" class="card hidden" role="alert"></section>

      <section id="dataset" class="card hidden">
        <h2>数据预览</h2>
        <div id="table-wrapper" class="table-wrapper"></div>
      </section>

      <section id="chart-config" class="card hidden">
        <div class="section-heading">
          <h2>数据图表</h2>
          <p>选择想要展示的横纵轴字段，快速生成图表。</p>
        </div>
        <div class="controls">
          <label>
            横轴：
            <select id="x-select"></select>
          </label>
          <label>
            纵轴：
            <select id="y-select"></select>
          </label>
        </div>
        <div class="chart-wrapper">
          <canvas id="data-chart" width="400" height="200" aria-label="Excel 数据图表" role="img"></canvas>
          <p id="chart-message" class="chart-message hidden"></p>
        </div>
      </section>
    </main>

    <footer>
      <div class="container">
        <small>所有数据仅在浏览器与本地服务器之间传输，确保安全。</small>
      </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </body>
</html>
